{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>All Expenses</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
<style>
:root {
    --primary-color: #4c6ef5;
    --secondary-color: #6c757d;
    --success-color: #198754;
    --bg-light: #f5f8ff;
}

body {
    background-color: var(--bg-light);
    font-family: 'Segoe UI', sans-serif;
    padding: 20px 10px;
}

.card {
    border-radius: 15px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.1);
    padding: 25px;
}

.header-actions {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    flex-wrap: wrap;
}

.header-actions h2 {
    margin: 0;
    font-weight: 600;
}

.header-actions .btn {
    min-width: 150px;
}

.btn-back {
    background-color: var(--secondary-color);
    color: white;
    transition: 0.3s;
}

.btn-back:hover {
    background-color: #5a6268;
    color: white;
}

.btn-add {
    background-color: var(--success-color);
    color: white;
    transition: 0.3s;
}

.btn-add:hover {
    background-color: #157347;
    color: white;
}

.table-responsive {
    overflow-x: auto;
}

table {
    border-collapse: separate;
    border-spacing: 0;
}

.table thead th {
    background-color: var(--primary-color);
    color: white;
    font-weight: 600;
}

.table-hover tbody tr:hover {
    background-color: #e3f2fd;
}

.action-btn {
    margin-right: 5px;
}

.bill-thumb {
    height: 50px;
    width: auto;
    border-radius: 6px;
    border: 1px solid #ddd;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}

@media (max-width: 576px) {
    .header-actions {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
    }
    .bill-thumb { height: 40px; }
    .header-actions .btn { min-width: auto; width: 100%; text-align: center; }
}
</style>
</head>
<body>
<br>
<div class="container">
    <div class="d-flex justify-content-between flex-wrap mb-3">
        <a href="{% url 'home' %}" class="btn btn-back">
            <i class="fas fa-arrow-left me-1"></i> Back to Home
        </a>
        <a href="{% url 'add_expense' %}" class="btn btn-add">
            <i class="fas fa-plus me-1"></i> Add Expense
        </a>
    </div>

    <div class="card">
        <!-- Totals -->
        <div class="mb-3">
            <p class="mb-0"><strong>Total Expense:</strong> ₹{{ total_expense }}</p>
        </div>

        {% if expenses %}
        <div class="table-responsive">
            <table class="table table-striped table-hover align-middle">
                <thead>
                    <tr>
                        <th>Expense ID</th>
                        <th>Title</th>
                        <th>Category</th>
                        <th>Date</th>
                        <th>Amount</th>
                        <th>Paid To</th>
                        <th>Notes</th>
                        <th>Bill</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for exp in expenses %}
                    <tr>
                        <td>{{ exp.expense_id }}</td>
                        <td>{{ exp.title }}</td>
                        <td>{{ exp.get_category_display }}</td>
                        <td>{{ exp.date }}</td>
                        <td>₹{{ exp.amount }}</td>
                        <td>{{ exp.paid_to }}</td>
                        <td>{{ exp.notes|default:"-" }}</td>
                        <td>
                            {% if exp.bill_photo %}
                                <a href="{{ exp.bill_photo.url }}" target="_blank">
                                    <img src="{{ exp.bill_photo.url }}" class="bill-thumb" alt="Bill Photo">
                                </a>
                            {% else %}
                                -
                            {% endif %}
                        </td>
                        <td>
                            <a href="{% url 'update_expense' exp.expense_id %}" class="btn btn-sm btn-primary action-btn"><i class="fas fa-edit"></i></a>
                            <a href="{% url 'delete_expense' exp.expense_id %}" class="btn btn-sm btn-danger"><i class="fas fa-trash-alt"></i></a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
            <p class="text-center">No expenses found. <a href="{% url 'add_expense' %}">Add your first expense</a></p>
        {% endif %}
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
